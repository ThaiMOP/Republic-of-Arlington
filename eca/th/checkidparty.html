<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สำนักงานคณะกรรมการการเลือกตั้ง</title>
    <link rel="icon" href="https://rep-arlington.pages.dev/assets/img/eca.png" type="image/gif" sizes="16x16">
    <link rel="stylesheet" href="https://slw-system.pages.dev/assets/css/font-face.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/checkidparty.css">
</head>
<body>
    <header>
        <img height="50px" src="https://rep-arlington.pages.dev/assets/img/eca.png" data-open="640">
        <h1>ระบบฐานข้อมูลพรรคการเมือง</h1>
    </header>
    
    <nav>
        <ul>
            <li><a href="dataparty">เกี่ยวกับพรรคการเมือง</a></li>
            <li><a href="checkidparty">ตรวจสอบการเป็นสมาชิกพรรคการเมือง</a></li>
            <li><a href="login">เข้าสู่ระบบ</a></li>
        </ul>
    </nav>
    <marquee class="marquee-text">
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          การตรวจสอบข้อมูลสมาชิกพรรคการเมืองในระบบฐานข้อมูลพรรคการเมืองเป็นข้อมูลที่พรรคการเมืองนำเข้า&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </marquee>
    <section class="block-wrapper">
      <div class="container">
	<div class="row" style="padding-bottom: 15px;">
	  <div class="col-md-12 text-center" style="padding-top: 15px;"><h4>ตรวจสอบการเป็นสมาชิกพรรคการเมือง</h4><h5>Check the membership of political parties</h5></div>
  	</div>
        <div class="panel panel-default">
	  <div class="panel-body" style="margin-bottom:20px">
            <label>หมายเลขประจำตัวประชาชน</label>
            <input type="text" class="form-control" value="" name="id_card" id="idCard" maxlength="21">
	  </div>
	  <div class="reCapcha">
		<button type="button" class="btn btn btn-primary btn-secondary " disabled="">ตรวจสอบ</button>
	  </div>
	  <div class="panel-footer result-print-check-id-party" id="result">
	  </div>
    </div>
</div>
	</section>

    <footer>
        <p>© สงวนลิขสิทธิ์ 2568</p>
    </footer>
	<script>
		document.addEventListener("DOMContentLoaded", function () {
		    const idCardInput = document.getElementById("idCard");
		    const checkButton = document.querySelector(".btn-primary");
		    const resultTableBody = document.querySelector(".mtable tbody");
		    const todaySpan = document.getElementById("today");
		    const reportNowSpan = document.querySelector(".report-now");
		    
		    checkButton.addEventListener("click", async function () {
		        const idCardValue = idCardInput.value.trim();
		        if (!idCardValue) {
		            alert("กรุณากรอกหมายเลขประจำตัวประชาชน");
		            return;
		        }
		        
		        try {
		            const response = await fetch(`https://script.google.com/macros/s/AKfycbyXIpdKy5QRwuVG9rAffwPMJ4iLukxPyQu2DUzUzU7bS0wXNJAIpobRL4sIzFzvCngw/exec?id_card=${idCardValue}`);
		            const data = await response.json();
		            
		            resultTableBody.innerHTML = ""; // เคลียร์ข้อมูลเก่า
		            
		            if (data && data.length > 0) {
		                data.forEach((item, index) => {
		                    const row = `<tr>
		                        <td>${index + 1}</td>
		                        <td class="text-left">${item.name || ""}</td>
		                        <td>${item.id_card || ""}</td>
		                        <td>${item.party || ""}</td>
		                        <td>${item.member_id || ""}</td>
		                        <td>${item.start_date || ""}</td>
		                        <td>${item.end_date || ""}</td>
		                        <td>${item.note || ""}</td>
		                    </tr>`;
		                    resultTableBody.innerHTML += row;
		                });
		            } else {
		                resultTableBody.innerHTML = `<tr>
		                    <td>1</td>
		                    <td class="text-left"></td>
		                    <td>${idCardValue}</td>
		                    <td></td>
		                    <td></td>
		                    <td></td>
		                    <td></td>
		                    <td>ไม่พบข้อมูล</td>
		                </tr>`;
		            }
		
		            // อัปเดตวันที่ตรวจสอบ
		            const now = new Date();
		            const formattedDate = now.toLocaleDateString("th-TH", {
		                year: "numeric", month: "long", day: "numeric"
		            });
		            todaySpan.textContent = formattedDate;
		            reportNowSpan.textContent = formattedDate;
		        } catch (error) {
		            console.error("Error fetching data:", error);
		            alert("เกิดข้อผิดพลาดในการดึงข้อมูล");
		        }
		    });
		});
	</script>
</body>
</html>
