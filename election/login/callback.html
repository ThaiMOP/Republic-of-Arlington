<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Discord Login Callback</title>
  <link rel="icon" href="https://rep-arlington.pages.dev/assets/img/eca.png" type="image/gif" sizes="16x16">
  <link rel="stylesheet" href="https://slw-system.pages.dev/assets/css/font-face.css">
</head>
<body>
  <h2>Logging in...</h2>
  <script>
    const fragment = new URLSearchParams(window.location.hash.slice(1));
    const accessToken = fragment.get('access_token');

    if (accessToken) {
      fetch('https://discord.com/api/users/@me', {
        headers: {
          Authorization: `Bearer ${accessToken}`
        }
      })
        .then(res => res.json())
        .then(user => {
          document.body.innerHTML = `
            <h1>Welcome, ${user.username}#${user.discriminator}!</h1>
            <img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png" alt="Avatar" width="100" />
          `;
        })
        .catch(err => {
          console.error(err);
          document.body.innerHTML = '<p>Failed to fetch user info</p>';
        });
    } else {
      document.body.innerHTML = '<p>No access token found</p>';
    }
  </script>
</body>
</html>
